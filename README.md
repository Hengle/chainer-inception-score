# Inception Score Module

Chainer implementation of the inception score module presented in [Improved Techniques for Training GANs](https://arxiv.org/abs/1606.03498). The code is derived from the official OpenAI implementation at https://github.com/openai/improved-gan.

## Inception Score

A method proposed by Tim Salimans et al. (2016) in the above mentioned paper to evaluate generated image quality for generative models such as VAEs and GANs.

It is based on the fact that good samples (images generated from a generative model) are expected to give

- Low entropy p(y|x), i.e. high prediction confidence
- High entropy p(y), i.e. highly varied predictions

to the inception network, where x is an image generated by the generative model and y is the class prediction. 

The inception score is thus defined as exp(E_x[KL(p(y|x) || p(y))])

## Usage

Download the pretrained TensorFlow model and create a Chainer copy named *inception_score.model*.

```bash
python download.py --outfile inception_score.model
```

Load the pretrained Chainer model and compute the inception score with 50000 images from CIFAR-10.

```
python example.py --infile inception_score.model --samples 50000
```

```
...
Batch size: 100
Total number of images: 50000
Total number of batches: 500
Running batch 1 / 500 ...
Running batch 2 / 500 ...
...
Running batch 500 / 500 ...
Inception score mean: 12.4307
Inception score std: 0.2018
```

### Example Usage in Python

```python
from chainer import serializers, datasets
from inception_score import Inception, inception_score

model = Inception()
serializers.load_hdf5('inception_score.model', model)

ims, _ = datasets.get_cifar10(ndim=3, withlabel=False, scale=255.0)
ims = ims[:50000]
mean, std = inception_score(model, ims)

print('Inception score mean:', mean)
print('Inception score std:', std)

```

## Note

This implementation seems to yield slightly higher scores than the original implementation looking at the inception scores for the first 50000 images in CIFAR-10, upsampled to (299, 299) using `scipy.misc.imresize` with bilinear interpolation.

|| This | Original |
| ------------- | ------------- | ------------- |
| Mean | 11.95 | 11.24 |
| Std  | 0.11 | 0.12 |
